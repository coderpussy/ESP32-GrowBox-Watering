<!DOCTYPE html>
<html>
    <head>
        <title data-translate="title">Growbox Watering</title>
        <meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link rel="stylesheet" type="text/css" href="css/index.css">
    </head>

    <body>
        <input id="dark-mode" class="dark-mode-checkbox visually-hidden" type="checkbox" />

        <div class="topnav">
            <div class="box box1">
                <div data-translate="title">Growbox Watering</div>
            </div>
            <div class="box box2">
                <div class="wifi-icon toggle-overlay wifi"></div>
                <div class="calendar-dates toggle-overlay calendar"></div>
                <div class="power-plug toggle-overlay webserial"></div>
                <div class="gear toggle-overlay settings">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="gear-inner"></div>
                </div>
                <div>
                    <label class="dark-mode-label" for="dark-mode">
                        <span class="toggle">
                            <span class="circle"></span>
                        </span>
                    </label>
                </div>
                <div class="custom-select">
                    <select id="language-select">
                        <option value="en">English</option>
                        <option value="de">Deutsch</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="theme-container">

            <table>
                <tr>
                    <td style="text-align: center;">
                        <span data-translate="automatic_watering">Automatic Watering:</span><br /><br />
                        <span id="mode"></span>
                        <label class="auto-switch" for="auto_switch">
                            <input type="checkbox" id="auto_switch" />
                            <div class="auto-slider round"></div>
                        </label>
                    </td>
                </tr>
            </table>

            <br />

            <div id="moistureSensorsWrapper">
                <div class="card" id="moisture-card" style="display: none;">
                    <div data-translate="moisture_sensors">Moisture Sensors</div>
                    <div id="moisture-sensors-container">
                        <!-- Moisture sensors will be inserted here dynamically -->
                    </div>
                </div>

                <br />
            </div>

            <table>
                <tr id="valve-controls">
                    <!-- Valve controls will be inserted here dynamically -->
                </tr>
            </table>

            <br />

            <table>
                <tr>
                    <td style="text-align: center;">
                        <span data-translate="water_pump">Water Pump:</span><br /><br />
                        <span id="pump_1"></span>
                        <label class="pump-switch" for="pump_switch">
                            <input type="checkbox" id="pump_switch" />
                            <div class="pump-slider round"></div>
                        </label>
                    </td>
                </tr>
            </table>

            <br />

            <table>
                <tr>
                    <td style="text-align: left;">
                        <span data-translate="runs">Runs:</span>
                        <span><span id="pumpRunTime"></span> <span data-translate="seconds">sec.</span></span>
                    </td>
                    <td>
                        <div id="soilFlowVolumeWrapper">
                            <span data-translate="soil_flow_rate">Soil Flow Rate:</span>
                            <span><span id="soilFlowVolume"></span> <span data-translate="litre">ltr.</span></span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-top: 10px; text-align: center;">
                        <input id="resetCounter" type="button" class="button" data-translate="reset_counter" value="Reset Counter">
                    </td>
                </tr>
            </table>

            <!-- Modal overlay boxes -->
            <div id="overlay-calendar">
                <span class="close toggle-overlay calendar"></span>
                <div class="content">
                    <h1 data-translate="job_scheduler">Job Scheduler</h1>
                    <div class="formcontrols">
                        <div class="job-form">
                            <input type="text" id="job-name" data-translate="job_name_placeholder" placeholder="Enter job name...">
                            <select id="job-select">
                                <option value="0" data-translate="timebased">Time-based</option>
                                <option value="1" data-translate="moisturesensor">Moisture Sensor</option>
                                <option value="2" data-translate="time_moisture">Time & Moisture</option>
                            </select>
                            <select id="plant-select">
                                <option value="0" data-translate="all_plants">All Plants</option>
                                <option value="1" data-translate="plant_1">Plant 1</option>
                                <option value="2" data-translate="plant_2">Plant 2</option>
                                <option value="3" data-translate="plant_3">Plant 3</option>
                            </select>
                            <div id="time-fields">
                                <input type="number" id="job-volume" min="1" data-translate="job_volume_placeholder" placeholder="e.g. 500" style="width: 80px;" required />
                                <span data-translate="millilitres">ml.</span><span class="validity"></span>
                                <input type="number" id="job-duration" min="2" max="120" data-translate="job_duration_placeholder" placeholder="e.g. 90" style="width: 70px;" required />
                                <span data-translate="seconds">sec.</span><span class="validity"></span>
                                <input type="datetime-local" id="starttime">
                                <input id="everyday" type="checkbox" /><span data-translate="every_day" id="everyday-label">every day</span>
                            </div>
                            <div id="moisture-fields">
                                <span id="container-min">
                                    <span>Min.</span>
                                    <input type="number" id="moisture-min" min="0" data-translate="moisture_min_placeholder" placeholder="e.g. 30" style="width: 70px;" required />
                                    <span>%</span>
                                </span>
                                <span id="container-max">
                                    <span>Max.</span>
                                    <input type="number" id="moisture-max" min="0" data-translate="moisture_max_placeholder" placeholder="e.g. 80" style="width: 70px;" required />
                                    <span>%</span>
                                </span>
                            </div>
                            <input id="add-job" type="button" class="button" data-translate="add_job" value="Add Job" />
                        </div>
                        <div class="job-list" id="job-list">
                            <!-- Tasks will be added here dynamically -->
                        </div>
                        <div class="manage-job-list">
                            <input id="save-jobs" type="button" class="button" data-translate="save_jobs" value="Save Jobs" />
                            <input id="delete-joblist" type="button" class="button" data-translate="delete_joblist" value="Delete Joblist" />
                        </div>
                    </div>
                </div>
            </div>

            <div id="overlay-webserial">
                <span class="close toggle-overlay webserial"></span>
                <div class="content">
                    <div class="formcontrols">
                        <iframe width="600" height="400" src="/webserial"></iframe>
                    </div>
                </div>
            </div>

            <div id="overlay-settings">
                <span class="close toggle-overlay settings"></span>
                <div class="content">
                    <h1 data-translate="settings">Settings</h1>
                    <div class="formcontrols">
                        <table>
                            <tr><td data-translate="use_webserial">Use Webserial:</td><td><input type="checkbox" id="use_webserial"></td></tr>
                            <tr><td data-translate="use_flowsensor">Use Soil Flow Sensor:</td><td><input type="checkbox" id="use_flowsensor"></td></tr>
                            <tr><td data-translate="use_moisturesensor">Use Soil Moisture Sensor:</td><td><input type="checkbox" id="use_moisturesensor"></td></tr>
                            <tr><td data-translate="auto_switch_enabled">Auto switch enabled by default:</td><td><input type="checkbox" id="auto_switch_enabled"></td></tr>
                            <tr><td data-translate="plant_count">Number of Plants:</td><td><input type="number" id="plant_count" min="1" max="8" value="3"></td></tr>
                            <tr><td colspan="2"><small data-translate="plant_count_warning" class="warning-text"></small></td></tr>
                        </table>
                        <p>
                            <input type="button" class="button toggle-overlay settings" data-translate="back" value="Back"> 
                            <input id="savesettings" type="button" class="button" data-translate="set" value="Set"> 
                        </p>
                    </div>
                </div>
            </div>

            <!-- WiFi Manager Overlay -->
            <div id="overlay-wifi">
                <span class="close toggle-overlay wifi"></span>
                <div class="content overlay-content wifi-manager-content">
                    <h1 data-translate="wifi_manager_title">WiFi Configuration</h1>
                    <div class="formcontrols">
                        <div id="wifi-message" class="message"></div>
                        <div id="wifi-loading" class="loading">
                            <div class="spinner"></div>
                            <p data-translate="connecting">Connecting...</p>
                        </div>
                        <div id="wifi-form-container">
                            <button type="button" id="scanNetworks" class="button scan-button">
                                <span data-translate="scan_networks">Scan Networks</span>
                            </button>
                            <label for="wifi-ssid" data-translate="wifi_network">WiFi Network:</label>
                            <select id="wifi-ssid" class="input-field">
                                <option value="" data-translate="select_network">Select a network</option>
                            </select>
                            <label for="wifi-ssid-manual" data-translate="manual_ssid">Or enter SSID manually:</label>
                            <input type="text" id="wifi-ssid-manual" class="input-field" placeholder="Enter SSID">
                            <label for="wifi-password" data-translate="password">Password:</label>
                            <input type="password" id="wifi-password" class="input-field" placeholder="Enter WiFi password">
                            <button type="button" id="connectWiFi" class="button">
                                <span data-translate="connect">Connect</span>
                            </button>
                            <button type="button" id="resetWiFi" class="button reset-button">
                                <span data-translate="reset_wifi">Reset WiFi Settings</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <script src="js/index.js" type="module"></script>
    </body>
</html>